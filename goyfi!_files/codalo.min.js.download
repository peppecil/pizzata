var editors=[],wh,ww,colw,advw,outw,device="desktop",$sx=$("#col-sx"),$output=$("#output"),$viewport=$("#viewport"),$dx=$("#col-dx"),$dw=$("#download");function initACE(b,a){var c=ace.edit(b);c.setOptions({mode:"ace/mode/"+a,tabSize:2,showPrintMargin:!1,autoScrollEditorIntoView:!0});c.session.on("change",function(b){updACE(c,a)});editors[b]=c}function updACE(b,a){var c=b.session.getValue();$("input[name="+a+"]").val(c)}
function emptyedt(){var b=editors["editor-js"].session.getValue(),a=editors["editor-css"].session.getValue(),c=editors["editor-html"].session.getValue();return 0==(b+a+c).length?!0:!1}function extcnt(b){$("#cnt-"+b).text($("#tab-"+b+" input").filter(function(){return this.value}).length)}function modal(b,a){"apri"==b?$("#modal").fadeIn(function(){$("#modal-"+a).show()}):$("#modal").fadeOut(function(){$("#modal-"+a).hide()})}
function showifr(){$sx.hasClass("L")?$("#espandi-edt").click():$sx.hasClass("A")&&$("#chiudi-edt").click();var b=$("#vp").val();if("desktop"==device)if("FULL"==b)b=outw,$dx.length||(b+=advw),$output.removeClass("ridotto").css({width:b,height:"100%",top:0,left:colw+"px"});else{b=b.split("x");var a=(wh-b[1])/2,c=colw+(outw-b[0])/2;$dx.length||(c+=Math.ceil(advw/2));a=0>a?0:a;$output.addClass("ridotto").css({width:b[0],height:b[1],top:a+"px",left:c+"px"})}}
$(window).on("resize",function(){wh=$(window).height();ww=$(window).width();colw=$sx.is(":hidden")?0:$sx.outerWidth();advw=$dx.is(":hidden")?0:$dx.outerWidth();outw=ww-colw-advw;device=768>ww?"mobile":768<=ww&&1028>ww?"tablet":"desktop";if($output.hasClass("ridotto")){var b=(wh-$output.height())/2,a=colw+(outw-$output.width())/2;$dx.length||(a+=Math.ceil(advw/2));$output.css({top:b+"px",left:a+"px"})}else $output.width("mobile"==device?"100%":outw);$viewport.is(":hidden")&&setTimeout(function(){$viewport.fadeIn();
$output.css({background:"#FFF"})},1200)}).trigger("resize");
$(function(){$(".editor").each(function(a){a=$(this).attr("id");var b=$(this).data("lang");initACE(a,b)});var b=[];b.js=$("#tab-js .extitm:last").prop("outerHTML");b.css=$("#tab-css .extitm:last").prop("outerHTML");$(".tabbtn li").click(function(){$(".tabbtn li.attivo").removeClass("attivo");$(this).addClass("attivo");var a=$(this).data("tab");$(".tab.attivo").removeClass("attivo");$("#tab-"+a).addClass("attivo")});$(".tab").on("click",".extitm i",function(){var a=$(this).parents(".extitm"),c=$(this).data("act"),
d=$(this).data("lng");"-"==c?1==$("#tab-"+d+" .extitm").length?a.find("input").val(""):a.remove():a.after(b[d]);extcnt(d)});$("select.extsel").change(function(){var a=$(this),c=a.val(),d=a.data("lng"),e=$("#tab-"+d+" input:last"),f=e.parents(".extitm");""==e.val()?e.val(c):(f.after(b[d]),$("#tab-"+d+" input:last").val(c));a.val("");extcnt(d)});$("#apri-edt").click(function(){$(this).hide();$("body").addClass("noscroll");$sx.css("margin-left","-"+("mobile"==device?ww:outw)+"px").width("mobile"==device?
ww:outw).show().animate({"margin-left":0},300,function(){$(this).attr("class","A");"mobile"==device&&$(this).width("")})});$("#chiudi-edt").click(function(){$sx.animate({"margin-left":"-"+("mobile"==device?ww:outw)+"px"},300,function(){$(this).hide().css("margin-left","").attr("class","C");$("#apri-edt").show();$("body").removeClass("noscroll")})});$("#espandi-edt").click(function(){var a=$(this);if($sx.hasClass("S")){var b=$dx.length&&!$dx.is(":hidden")?ww-advw:ww;$sx.attr("class","L").animate({width:b+
"px"},500,function(){a.attr("class","icon-left-open-big")})}else $sx.attr("class","S").animate({width:colw+"px"},500,function(){a.attr("class","icon-right-open-big")})});$("#esegui").click(function(){1==emptyedt()?modal("apri","vuoto"):(showifr(),$dw.val("0"),$("#modulo").submit())});$("#scarica").click(function(){1==emptyedt()?modal("apri","vuoto"):(showifr(),$dw.val("1"),$("#modulo").submit())});$("#nuovo").click(function(){modal("apri","nuovo")});$("#nuovo-exe").click(function(){$("#admin").length?
location.href="./":(modal("chiudi","nuovo"),$("body").data("codeid")&&(window.history.pushState?(document.title="<codalo/> - Prova il tuo codice su Mr. Webmaster",window.history.pushState({},"","./")):location.href="./"),$("#cnt-js,#cnt-css").text("0"),$("#tab-css .extitm").not(":first").remove(),$("#tab-js .extitm").not(":first").remove(),$(".extitm input").val(""),$(".editor").each(function(a){a=$(this).attr("id");editors[a].setValue("")}),$("#modulo")[0].reset(),$("#esegui").click())});$("#chiudi-adv").click(function(){$dx.animate({width:0},
200,function(){$(this).remove()});$output.hasClass("ridotto")?$output.animate({left:"+="+Math.ceil(advw/2)+"px"},200):$output.animate({width:"+="+advw+"px"},200);outw=ww-colw})});